{% extends 'base.html' %}
{% block styles %}
{{ super() }}
{% endblock %}
{% block scripts %}
<script>
    document.querySelectorAll('.day-link').forEach(function(link) {
        link.addEventListener('click', function(event) {
            event.preventDefault(); 
            
            var newDay = link.textContent.trim();
            
            document.querySelector('h1').textContent = 'Événements du festival pour le ' + newDay;
            
            var xhr = new XMLHttpRequest();
            xhr.open('GET', link.href, true);

            xhr.onload = function() {
                if (xhr.status >= 200 && xhr.status < 400) {
                    document.querySelector('.events-container').innerHTML = xhr.responseText;
                }
            };

            xhr.send();
        });
    });
</script>
{% endblock %}

{% block main %}
    <link rel="stylesheet" href="{{ url_for('static', filename='css/day_detail.css')}}">

    <h1>{{ festival.nomFestival }}</h1>

    <h2>Événements du festival pour le {{ day }}</h2>

    <div class="days-container">
        {% for event_day in events_by_day %}
            {% if event_day != day %}
                <a class="day" href="{{ url_for('day_detail', festival_id=festival.idFestival, day=event_day.strftime('%Y-%m-%d')) }}" class="day-link">{{ event_day.strftime('%Y-%m-%d') }}</a>
            {% endif %}
        {% endfor %}
    </div>
    <p class="info">Passez la souris sur les images pour plus d'informations</p>
    <div class="affichageDetail">
        {% for event in events_for_day %}
            <div class="event">
                {% if event.imageEvent %}
                    <img class="imgProg" src="{{ event.imageEvent}}" alt="image du programme">
                {% endif %}
                <div class="evt" href="#">
                    <p><strong>Nom de l'évènement : </strong>{{ event.nomEvent }}</p>
                    <p><strong>Le type d'évènement : </strong>{{ event.typeEvent }}</p>
                    <p><strong>Durée de l'évènement : </strong>{{ event.dateHeureDebutEvent | datetime_format('%Hh:%M') }} - {{ event.dateHeureFinEvent | datetime_format('%Hh:%M') }}</p>
                    <p class="gratuitPayant">{{"Évènement Gratuit" if event.estGratuit else "Évènement Payant" }}</p>
                    <p><strong>Adresse de l'évènement : </strong>{{ event.adresseEvent }}</p>
                    <p><strong>Nombre de place : </strong>{{ event.nbPlaceEvent }}</p>
                    <p>{{ "" if event.imageEvent == None else event.imageEvent }}</p>
                </div>
            </div>
        {% endfor %}
    </div>   
{% endblock %}
